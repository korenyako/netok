<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Etsy-style Hover Effects Demo (Fixed)</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
      background: #f5f5f5;
      min-height: 100vh;
      padding: 40px 20px;
    }

    .demo-section {
      max-width: 800px;
      margin: 0 auto 40px;
      background: white;
      border-radius: 16px;
      padding: 32px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.08);
    }

    h1 {
      font-size: 24px;
      margin-bottom: 24px;
      color: #222;
    }

    h2 {
      font-size: 16px;
      color: #666;
      margin-bottom: 16px;
      font-weight: 500;
    }

    .demo-label {
      display: inline-block;
      font-size: 12px;
      color: #888;
      margin-bottom: 8px;
    }

    /* ===========================================
       ICON BUTTONS (как иконки в хедере Etsy)
       =========================================== */
    
    .icon-buttons {
      display: flex;
      gap: 8px;
      align-items: center;
      margin-bottom: 32px;
    }

    .icon-btn {
      /* Reset */
      background: none;
      border: none;
      cursor: pointer;
      outline: none;
      
      /* Sizing */
      width: 48px;
      height: 48px;
      padding: 12px;
      
      /* КЛЮЧЕВОЕ: создаём stacking context */
      position: relative;
      z-index: 1;  /* <-- ЭТО ВАЖНО! */
      
      display: inline-flex;
      align-items: center;
      justify-content: center;
      color: #222;
    }

    .icon-btn::after {
      content: "";
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      border-radius: 50%;
      background-color: rgba(0, 150, 200, 0.12);
      z-index: -1;
      
      /* Начинаем с 0 — полностью невидимый */
      transform: scale(0);
      transition: transform 200ms cubic-bezier(0.345, 0.115, 0.135, 1.42);
    }

    .icon-btn:hover::after {
      transform: scale(1);
    }

    .icon-btn:active::after {
      transform: scale(0.95);
    }

    .icon-btn svg {
      width: 24px;
      height: 24px;
      position: relative; /* чтобы иконка была над фоном */
    }

    /* ===========================================
       MENU ITEMS (как пункты меню в навигации)
       =========================================== */
    
    .menu-nav {
      display: flex;
      gap: 4px;
      margin-bottom: 32px;
    }

    .menu-item {
      /* Reset */
      background: none;
      border: none;
      cursor: pointer;
      outline: none;
      text-decoration: none;
      
      /* Styling */
      padding: 10px 16px;
      font-size: 14px;
      font-weight: 500;
      color: #222;
      
      /* КЛЮЧЕВОЕ: stacking context */
      position: relative;
      z-index: 1;
      
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }

    .menu-item::after {
      content: "";
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      border-radius: 24px;
      background-color: rgba(0, 0, 0, 0.06);
      z-index: -1;
      
      transform: scale(0);
      transition: transform 200ms cubic-bezier(0.345, 0.115, 0.135, 1.42);
    }

    .menu-item:hover::after {
      transform: scale(1);
    }

    .menu-item:active::after {
      transform: scale(0.95);
      background-color: rgba(0, 0, 0, 0.12);
    }

    /* ===========================================
       SEARCH BUTTON (морфинг формы)
       =========================================== */
    
    .search-container {
      display: flex;
      align-items: center;
      gap: 0;
      background: #f5f5f5;
      border-radius: 28px;
      max-width: 400px;
      margin-bottom: 32px;
      cursor: text;
      padding: 4px;
    }

    .search-input {
      flex: 1;
      border: none;
      background: transparent;
      padding: 12px 16px;
      font-size: 16px;
      outline: none;
    }

    .search-btn {
      background: #222;
      border: none;
      cursor: pointer;
      width: 48px;
      height: 48px;
      border-radius: 24px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      
      /* Расширение влево */
      transition: 
        width 200ms cubic-bezier(0.345, 0.115, 0.135, 1.42),
        padding 200ms cubic-bezier(0.345, 0.115, 0.135, 1.42);
    }

    .search-container:hover .search-btn,
    .search-container:focus-within .search-btn {
      width: 64px;
      padding-left: 4px;
    }

    .search-btn svg {
      width: 24px;
      height: 24px;
      flex-shrink: 0;
    }

    /* ===========================================
       ВАРИАНТ 2: overflow: hidden (альтернатива z-index)
       =========================================== */
    
    .icon-btn-v2 {
      background: none;
      border: none;
      cursor: pointer;
      outline: none;
      width: 48px;
      height: 48px;
      padding: 12px;
      position: relative;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      color: #222;
      
      /* Альтернативный подход — без z-index */
      overflow: hidden;
      border-radius: 50%;
    }

    .icon-btn-v2::before {
      content: "";
      position: absolute;
      top: 50%;
      left: 50%;
      width: 100%;
      height: 100%;
      border-radius: 50%;
      background-color: rgba(0, 150, 200, 0.12);
      
      transform: translate(-50%, -50%) scale(0);
      transition: transform 200ms cubic-bezier(0.345, 0.115, 0.135, 1.42);
    }

    .icon-btn-v2:hover::before {
      transform: translate(-50%, -50%) scale(1.1);
    }

    .icon-btn-v2:active::before {
      transform: translate(-50%, -50%) scale(0.95);
    }

    .icon-btn-v2 svg {
      width: 24px;
      height: 24px;
      position: relative;
      z-index: 1;
    }

    /* ===========================================
       CSS Variables версия для HiFiDB
       =========================================== */
    
    .hifi-btn {
      --btn-scale-start: 0;
      --btn-scale-hover: 1;
      --btn-bg: rgba(59, 130, 246, 0.12);
      --btn-easing: cubic-bezier(0.345, 0.115, 0.135, 1.42);
      
      background: none;
      border: none;
      cursor: pointer;
      outline: none;
      width: 48px;
      height: 48px;
      padding: 12px;
      
      /* Stacking context */
      position: relative;
      z-index: 1;
      
      display: inline-flex;
      align-items: center;
      justify-content: center;
      color: #222;
    }

    .hifi-btn::after {
      content: "";
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      border-radius: 50%;
      background-color: var(--btn-bg);
      z-index: -1;
      transform: scale(var(--btn-scale-start));
      transition: transform 200ms var(--btn-easing);
    }

    .hifi-btn:hover::after {
      transform: scale(var(--btn-scale-hover));
    }

    .hifi-btn:active::after {
      transform: scale(0.95);
    }

    .hifi-btn svg {
      width: 24px;
      height: 24px;
      position: relative;
    }

    /* Code block */
    pre {
      background: #1a1a2e;
      color: #eee;
      padding: 20px;
      border-radius: 12px;
      overflow-x: auto;
      font-size: 13px;
      line-height: 1.6;
    }

    .highlight { color: #7dd3fc; }
    .comment { color: #6b7280; }
    .important { color: #fbbf24; }
  </style>
</head>
<body>

  <div class="demo-section">
    <h1>Etsy-style Hover Effects (Fixed)</h1>
    
    <h2>1. Icon Buttons — z-index method</h2>
    <p class="demo-label">Требует z-index: 1 на родителе для работы z-index: -1 на ::after</p>
    <div class="icon-buttons">
      <button class="icon-btn" aria-label="Favorites">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"/>
        </svg>
      </button>
      <button class="icon-btn" aria-label="Gifts">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <rect x="3" y="8" width="18" height="4" rx="1"/>
          <path d="M12 8V21M5 12v9h14v-9"/>
          <path d="M7.5 8a2.5 2.5 0 0 1 0-5C9 3 12 6.5 12 8M16.5 8a2.5 2.5 0 0 0 0-5C15 3 12 6.5 12 8"/>
        </svg>
      </button>
      <button class="icon-btn" aria-label="Notifications">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"/>
          <path d="M13.73 21a2 2 0 0 1-3.46 0"/>
        </svg>
      </button>
      <button class="icon-btn" aria-label="Cart">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <circle cx="9" cy="21" r="1"/>
          <circle cx="20" cy="21" r="1"/>
          <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"/>
        </svg>
      </button>
    </div>

    <h2>2. Menu Items</h2>
    <p class="demo-label">Pill-shaped background с тем же принципом</p>
    <nav class="menu-nav">
      <a href="#" class="menu-item">Home Favorites</a>
      <a href="#" class="menu-item">Fashion Finds</a>
      <a href="#" class="menu-item">Registry</a>
      <a href="#" class="menu-item">Gift Cards</a>
    </nav>

    <h2>3. Search Button Morph</h2>
    <div class="search-container">
      <input type="text" class="search-input" placeholder="Search for anything">
      <button class="search-btn" aria-label="Search">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
          <circle cx="11" cy="11" r="8"/>
          <path d="M21 21l-4.35-4.35"/>
        </svg>
      </button>
    </div>

    <h2>4. Alternative: overflow:hidden + ::before</h2>
    <p class="demo-label">Без z-index, использует overflow:hidden и transform от центра</p>
    <div class="icon-buttons">
      <button class="icon-btn-v2" aria-label="Like">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M14 9V5a3 3 0 0 0-3-3l-4 9v11h11.28a2 2 0 0 0 2-1.7l1.38-9a2 2 0 0 0-2-2.3zM7 22H4a2 2 0 0 1-2-2v-7a2 2 0 0 1 2-2h3"/>
        </svg>
      </button>
      <button class="icon-btn-v2" aria-label="Share">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <circle cx="18" cy="5" r="3"/>
          <circle cx="6" cy="12" r="3"/>
          <circle cx="18" cy="19" r="3"/>
          <line x1="8.59" y1="13.51" x2="15.42" y2="17.49"/>
          <line x1="15.41" y1="6.51" x2="8.59" y2="10.49"/>
        </svg>
      </button>
      <button class="icon-btn-v2" aria-label="Bookmark">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"/>
        </svg>
      </button>
    </div>

    <h2>5. CSS Variables для HiFiDB</h2>
    <p class="demo-label">Легко менять цвет через --btn-bg</p>
    <div class="icon-buttons">
      <button class="hifi-btn" aria-label="Compare">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <rect x="3" y="3" width="7" height="7"/>
          <rect x="14" y="3" width="7" height="7"/>
          <rect x="14" y="14" width="7" height="7"/>
          <rect x="3" y="14" width="7" height="7"/>
        </svg>
      </button>
      <button class="hifi-btn" style="--btn-bg: rgba(34, 197, 94, 0.15);" aria-label="Add">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <line x1="12" y1="5" x2="12" y2="19"/>
          <line x1="5" y1="12" x2="19" y2="12"/>
        </svg>
      </button>
      <button class="hifi-btn" style="--btn-bg: rgba(239, 68, 68, 0.15);" aria-label="Delete">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <polyline points="3 6 5 6 21 6"/>
          <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/>
        </svg>
      </button>
    </div>
  </div>

  <div class="demo-section">
    <h1>Ключевой CSS</h1>
    <pre><code><span class="comment">/* Фон появляется только при hover */</span>

.icon-btn {
  position: relative;
  <span class="important">z-index: 1;</span>  <span class="comment">/* создаёт stacking context */</span>
}

.icon-btn::after {
  content: "";
  position: absolute;
  inset: 0;
  border-radius: 50%;
  background: rgba(0, 150, 200, 0.12);
  z-index: -1;
  
  <span class="comment">/* Начинаем с 0 — невидимый */</span>
  <span class="highlight">transform: scale(0);</span>
  
  <span class="comment">/* Etsy easing с "пружинкой" */</span>
  transition: transform 200ms <span class="highlight">cubic-bezier(0.345, 0.115, 0.135, 1.42)</span>;
}

.icon-btn:hover::after {
  <span class="highlight">transform: scale(1);</span>
}</code></pre>
  </div>

</body>
</html>
